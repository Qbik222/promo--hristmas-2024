"use strict";

(function () {
  // Cards slider
  var cardsContainer = document.querySelector('.prize__list'),
    cards = document.querySelectorAll('.prize__list-item'),
    cardsWrap = document.querySelector('.prize__list-scroll'),
    moveRightButton = document.querySelector('.prize__slider-move-right'),
    moveLeftButton = document.querySelector('.prize__slider-move-left'),
    tabsContainer = document.querySelector('.prize__tabs'),
    isMobile = window.innerWidth < 600,
    totalCards = cards.length,
    cardWidth = cards[0].clientWidth,
    cardsMargin = (cardsWrap.clientWidth - cardWidth * totalCards) / (totalCards - 1),
    visibleSlides = isMobile ? 1 : Math.floor(cardsContainer.clientWidth / (cardWidth + cardsMargin)),
    totalTabs = Math.ceil(totalCards / visibleSlides);
  var currentSlide = 1;
  var cardsPosition = 0;
  for (var i = 1; i <= totalTabs; i++) {
    if (!isMobile && i === totalTabs) {
      break;
    }
    var tab = document.createElement('div');
    tab.classList.add('prize__tabs-item');
    tabsContainer.appendChild(tab);
  }
  var updateActiveCard = function updateActiveCard(cards, activeIndex) {
    cards.forEach(function (card, i) {
      activeIndex - 1 === i ? card.classList.add("_active") : card.classList.remove("_active");
    });
  };
  updateActiveCard(cards, currentSlide);
  var updateTabs = function updateTabs() {
    var activeTab = Math.ceil(currentSlide / visibleSlides);
    tabsContainer.childNodes.forEach(function (tab, index) {
      tab.classList.toggle('_active', index + 1 === activeTab);
    });
  };
  updateTabs();
  function setCardsPosition(position) {
    cardsWrap.style.transform = "translateX(-".concat(position, "px)");
  }
  ;
  var moveRight = function moveRight() {
    if (currentSlide >= totalCards - visibleSlides && isMobile === false) {
      currentSlide = 1;
      cardsPosition = 0;
    } else if (currentSlide === totalCards) {
      currentSlide = 1;
      cardsPosition = 0;
    } else {
      var maxPosition = (totalCards - visibleSlides) * (cardWidth + cardsMargin);
      if (cardsPosition + cardWidth + cardsMargin > maxPosition) {
        cardsPosition = maxPosition;
        currentSlide = totalCards - visibleSlides + 1;
      } else {
        cardsPosition += cardWidth + cardsMargin;
        currentSlide++;
      }
    }
    setCardsPosition(cardsPosition);
    updateTabs();
    updateActiveCard(cards, currentSlide);
  };
  var moveLeft = function moveLeft() {
    if (currentSlide === 1 && isMobile === false) {
      currentSlide = totalCards - visibleSlides;
      cardsPosition = (totalCards - visibleSlides) * (cardWidth + cardsMargin) - (cardWidth + cardsMargin);
    } else if (currentSlide === 2) {
      cardsPosition = 0;
      currentSlide = 1;
    } else if (currentSlide === 1 && isMobile === true) {
      currentSlide = totalCards;
      cardsPosition = totalCards * (cardWidth + cardsMargin) - (cardWidth + cardsMargin);
    } else {
      cardsPosition -= cardWidth + cardsMargin;
      currentSlide--;
    }
    setCardsPosition(cardsPosition);
    updateTabs();
    updateActiveCard(cards, currentSlide);
  };

  // function centerStartPosition() {
  //         const startOffset = (window.innerWidth / 2) - ((cardWidth + cardsMargin) / 2);
  //         cardsPosition = startOffset > 0 ? startOffset : 0;
  //         setCardsPosition(cardsPosition);
  // };

  // snowfall animations
  (function () {
    var COUNT = 400;
    function Snowstorm(element) {
      this.masthead = element;
      this.canvas = document.createElement('canvas');
      this.ctx = this.canvas.getContext('2d');
      this.width = this.masthead.clientWidth;
      this.height = this.masthead.clientHeight;
      this.active = false;
      this.snowflakes = [];
      this.init();
    }
    Snowstorm.prototype.init = function () {
      this.canvas.style.position = 'absolute';
      this.canvas.style.left = this.canvas.style.top = '0';
      this.masthead.appendChild(this.canvas);
      this.onResize();
      window.addEventListener('resize', this.onResize.bind(this), false);
      for (var i = 0; i < COUNT; i++) {
        var snowflake = new this.Snowflake(this);
        snowflake.reset();
        this.snowflakes.push(snowflake);
      }
      if (this.active) {
        requestAnimFrame(this.update.bind(this));
      }
    };
    Snowstorm.prototype.onResize = function () {
      this.width = this.masthead.clientWidth;
      this.height = this.masthead.clientHeight;
      this.canvas.width = this.width;
      this.canvas.height = this.height;
      this.ctx.fillStyle = '#FFF';
      var wasActive = this.active;
      this.active = this.width > 80;
      this.width > 280 ? COUNT = 150 : null;
      if (!wasActive && this.active) {
        requestAnimFrame(this.update.bind(this));
      }
    };
    Snowstorm.prototype.update = function () {
      this.ctx.clearRect(0, 0, this.width, this.height);
      if (!this.active) {
        return;
      }
      for (var i = 0; i < COUNT; i++) {
        var snowflake = this.snowflakes[i];
        snowflake.y += snowflake.vy;
        snowflake.x += snowflake.vx;
        this.ctx.globalAlpha = snowflake.o;
        this.ctx.beginPath();
        this.ctx.arc(snowflake.x, snowflake.y, snowflake.r, 0, Math.PI * 2, false);
        this.ctx.closePath();
        this.ctx.fill();
        if (snowflake.y > this.height) {
          snowflake.reset();
        }
      }
      requestAnimFrame(this.update.bind(this));
    };
    Snowstorm.prototype.Snowflake = function (snowstorm) {
      this.snowstorm = snowstorm;
      this.reset();
    };
    Snowstorm.prototype.Snowflake.prototype.reset = function () {
      this.x = Math.random() * this.snowstorm.width;
      this.y = Math.random() * -this.snowstorm.height;
      this.vy = 0.3 + Math.random() * 0.00001;
      this.vx = 0.6 - Math.random();
      this.r = 1 + Math.random() * 2;
      this.o = 1;
    };

    // shim layer with setTimeout fallback
    window.requestAnimFrame = function () {
      return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (callback) {
        window.setTimeout(callback, 1000 / 60);
      };
    }();

    // Apply Snowstorm to all elements with the class 'sky'
    var skies = document.querySelectorAll('.sky');
    skies.forEach(function (sky) {
      new Snowstorm(sky);
    });
  })();
  var handleResize = function handleResize() {
    var touchStartX = 0;
    var touchEndX = 0;
    var handleTouchStart = function handleTouchStart(event) {
      touchStartX = event.touches[0].clientX;
    };
    var handleTouchMove = function handleTouchMove(event) {
      touchEndX = event.touches[0].clientX;
    };
    var handleTouchEnd = function handleTouchEnd() {
      var swipeDistance = touchStartX - touchEndX;
      if (swipeDistance > 50) {
        // Свайп ліворуч
        moveRight();
      } else if (swipeDistance < -50) {
        // Свайп праворуч
        moveLeft();
      }
      // Скидаємо значення
      touchStartX = 0;
      touchEndX = 0;
    };
    moveRightButton.addEventListener('click', moveRight);
    moveLeftButton.addEventListener('click', moveLeft);
    cardsContainer.addEventListener('touchstart', handleTouchStart);
    cardsContainer.addEventListener('touchmove', handleTouchMove);
    cardsContainer.addEventListener('touchend', handleTouchEnd);
    window.addEventListener("orientationchange", function () {
      location.reload();
    });
  };
  handleResize();
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiY2FyZHNDb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjYXJkcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjYXJkc1dyYXAiLCJtb3ZlUmlnaHRCdXR0b24iLCJtb3ZlTGVmdEJ1dHRvbiIsInRhYnNDb250YWluZXIiLCJpc01vYmlsZSIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJ0b3RhbENhcmRzIiwibGVuZ3RoIiwiY2FyZFdpZHRoIiwiY2xpZW50V2lkdGgiLCJjYXJkc01hcmdpbiIsInZpc2libGVTbGlkZXMiLCJNYXRoIiwiZmxvb3IiLCJ0b3RhbFRhYnMiLCJjZWlsIiwiY3VycmVudFNsaWRlIiwiY2FyZHNQb3NpdGlvbiIsImkiLCJ0YWIiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJ1cGRhdGVBY3RpdmVDYXJkIiwiYWN0aXZlSW5kZXgiLCJmb3JFYWNoIiwiY2FyZCIsInJlbW92ZSIsInVwZGF0ZVRhYnMiLCJhY3RpdmVUYWIiLCJjaGlsZE5vZGVzIiwiaW5kZXgiLCJ0b2dnbGUiLCJzZXRDYXJkc1Bvc2l0aW9uIiwicG9zaXRpb24iLCJzdHlsZSIsInRyYW5zZm9ybSIsIm1vdmVSaWdodCIsIm1heFBvc2l0aW9uIiwibW92ZUxlZnQiLCJDT1VOVCIsIlNub3dzdG9ybSIsImVsZW1lbnQiLCJtYXN0aGVhZCIsImNhbnZhcyIsImN0eCIsImdldENvbnRleHQiLCJ3aWR0aCIsImhlaWdodCIsImNsaWVudEhlaWdodCIsImFjdGl2ZSIsInNub3dmbGFrZXMiLCJpbml0IiwicHJvdG90eXBlIiwibGVmdCIsInRvcCIsIm9uUmVzaXplIiwiYWRkRXZlbnRMaXN0ZW5lciIsImJpbmQiLCJzbm93Zmxha2UiLCJTbm93Zmxha2UiLCJyZXNldCIsInB1c2giLCJyZXF1ZXN0QW5pbUZyYW1lIiwidXBkYXRlIiwiZmlsbFN0eWxlIiwid2FzQWN0aXZlIiwiY2xlYXJSZWN0IiwieSIsInZ5IiwieCIsInZ4IiwiZ2xvYmFsQWxwaGEiLCJvIiwiYmVnaW5QYXRoIiwiYXJjIiwiciIsIlBJIiwiY2xvc2VQYXRoIiwiZmlsbCIsInNub3dzdG9ybSIsInJhbmRvbSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1velJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNhbGxiYWNrIiwic2V0VGltZW91dCIsInNraWVzIiwic2t5IiwiaGFuZGxlUmVzaXplIiwidG91Y2hTdGFydFgiLCJ0b3VjaEVuZFgiLCJoYW5kbGVUb3VjaFN0YXJ0IiwiZXZlbnQiLCJ0b3VjaGVzIiwiY2xpZW50WCIsImhhbmRsZVRvdWNoTW92ZSIsImhhbmRsZVRvdWNoRW5kIiwic3dpcGVEaXN0YW5jZSIsImxvY2F0aW9uIiwicmVsb2FkIl0sIm1hcHBpbmdzIjoiOztBQUFBLENBQUMsWUFBWTtFQUNUO0VBQ0EsSUFBTUEsY0FBYyxHQUFHQyxRQUFRLENBQUNDLGFBQWEsQ0FBQyxjQUFjLENBQUM7SUFDdkRDLEtBQUssR0FBR0YsUUFBUSxDQUFDRyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQztJQUN0REMsU0FBUyxHQUFHSixRQUFRLENBQUNDLGFBQWEsQ0FBQyxxQkFBcUIsQ0FBQztJQUN6REksZUFBZSxHQUFHTCxRQUFRLENBQUNDLGFBQWEsQ0FBQywyQkFBMkIsQ0FBQztJQUNyRUssY0FBYyxHQUFHTixRQUFRLENBQUNDLGFBQWEsQ0FBQywwQkFBMEIsQ0FBQztJQUNuRU0sYUFBYSxHQUFHUCxRQUFRLENBQUNDLGFBQWEsQ0FBQyxjQUFjLENBQUM7SUFDdERPLFFBQVEsR0FBR0MsTUFBTSxDQUFDQyxVQUFVLEdBQUcsR0FBRztJQUNsQ0MsVUFBVSxHQUFHVCxLQUFLLENBQUNVLE1BQU07SUFDekJDLFNBQVMsR0FBR1gsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDWSxXQUFXO0lBQ2hDQyxXQUFXLEdBQUcsQ0FBQ1gsU0FBUyxDQUFDVSxXQUFXLEdBQUdELFNBQVMsR0FBR0YsVUFBVSxLQUFLQSxVQUFVLEdBQUcsQ0FBQyxDQUFDO0lBQ2pGSyxhQUFhLEdBQUdSLFFBQVEsR0FBRyxDQUFDLEdBQUdTLElBQUksQ0FBQ0MsS0FBSyxDQUFDbkIsY0FBYyxDQUFDZSxXQUFXLElBQUlELFNBQVMsR0FBR0UsV0FBVyxDQUFDLENBQUM7SUFDakdJLFNBQVMsR0FBR0YsSUFBSSxDQUFDRyxJQUFJLENBQUNULFVBQVUsR0FBR0ssYUFBYSxDQUFDO0VBRXZELElBQUlLLFlBQVksR0FBRyxDQUFDO0VBQ3BCLElBQUlDLGFBQWEsR0FBRyxDQUFDO0VBQ2pCLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxJQUFJSixTQUFTLEVBQUVJLENBQUMsRUFBRSxFQUFFO0lBQ2pDLElBQUcsQ0FBQ2YsUUFBUSxJQUFJZSxDQUFDLEtBQUtKLFNBQVMsRUFBRTtNQUM3QjtJQUNKO0lBQ0EsSUFBTUssR0FBRyxHQUFHeEIsUUFBUSxDQUFDeUIsYUFBYSxDQUFDLEtBQUssQ0FBQztJQUN6Q0QsR0FBRyxDQUFDRSxTQUFTLENBQUNDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQztJQUNyQ3BCLGFBQWEsQ0FBQ3FCLFdBQVcsQ0FBQ0osR0FBRyxDQUFDO0VBQ2xDO0VBRUosSUFBTUssZ0JBQWdCLEdBQUcsU0FBbkJBLGdCQUFnQixDQUFJM0IsS0FBSyxFQUFFNEIsV0FBVyxFQUFLO0lBQzdDNUIsS0FBSyxDQUFDNkIsT0FBTyxDQUFDLFVBQUNDLElBQUksRUFBRVQsQ0FBQyxFQUFJO01BQ3RCTyxXQUFXLEdBQUcsQ0FBQyxLQUFLUCxDQUFDLEdBQUdTLElBQUksQ0FBQ04sU0FBUyxDQUFDQyxHQUFHLENBQUMsU0FBUyxDQUFDLEdBQUdLLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxNQUFNLENBQUMsU0FBUyxDQUFDO0lBQzVGLENBQUMsQ0FBQztFQUNOLENBQUM7RUFDREosZ0JBQWdCLENBQUMzQixLQUFLLEVBQUVtQixZQUFZLENBQUM7RUFFckMsSUFBTWEsVUFBVSxHQUFHLFNBQWJBLFVBQVUsR0FBUztJQUNyQixJQUFNQyxTQUFTLEdBQUdsQixJQUFJLENBQUNHLElBQUksQ0FBQ0MsWUFBWSxHQUFHTCxhQUFhLENBQUM7SUFDekRULGFBQWEsQ0FBQzZCLFVBQVUsQ0FBQ0wsT0FBTyxDQUFDLFVBQUNQLEdBQUcsRUFBRWEsS0FBSyxFQUFLO01BQzdDYixHQUFHLENBQUNFLFNBQVMsQ0FBQ1ksTUFBTSxDQUFDLFNBQVMsRUFBRUQsS0FBSyxHQUFHLENBQUMsS0FBS0YsU0FBUyxDQUFDO0lBQzVELENBQUMsQ0FBQztFQUNOLENBQUM7RUFDREQsVUFBVSxFQUFFO0VBQ1osU0FBU0ssZ0JBQWdCLENBQUVDLFFBQVEsRUFBRTtJQUNqQ3BDLFNBQVMsQ0FBQ3FDLEtBQUssQ0FBQ0MsU0FBUyx5QkFBa0JGLFFBQVEsUUFBSztFQUM1RDtFQUFDO0VBQ0QsSUFBTUcsU0FBUyxHQUFHLFNBQVpBLFNBQVMsR0FBUztJQUNwQixJQUFJdEIsWUFBWSxJQUFJVixVQUFVLEdBQUdLLGFBQWEsSUFBSVIsUUFBUSxLQUFLLEtBQUssRUFBRTtNQUNsRWEsWUFBWSxHQUFHLENBQUM7TUFDaEJDLGFBQWEsR0FBRyxDQUFDO0lBQ3JCLENBQUMsTUFBSyxJQUFHRCxZQUFZLEtBQUtWLFVBQVUsRUFBRTtNQUNsQ1UsWUFBWSxHQUFHLENBQUM7TUFDaEJDLGFBQWEsR0FBRyxDQUFDO0lBQ3JCLENBQUMsTUFBSztNQUNGLElBQU1zQixXQUFXLEdBQUcsQ0FBQ2pDLFVBQVUsR0FBR0ssYUFBYSxLQUFLSCxTQUFTLEdBQUdFLFdBQVcsQ0FBQztNQUM1RSxJQUFJTyxhQUFhLEdBQUdULFNBQVMsR0FBR0UsV0FBVyxHQUFHNkIsV0FBVyxFQUFFO1FBQ3ZEdEIsYUFBYSxHQUFHc0IsV0FBVztRQUMzQnZCLFlBQVksR0FBR1YsVUFBVSxHQUFHSyxhQUFhLEdBQUcsQ0FBQztNQUNqRCxDQUFDLE1BQU07UUFDSE0sYUFBYSxJQUFJVCxTQUFTLEdBQUdFLFdBQVc7UUFDeENNLFlBQVksRUFBRTtNQUNsQjtJQUNKO0lBQ0FrQixnQkFBZ0IsQ0FBQ2pCLGFBQWEsQ0FBQztJQUMvQlksVUFBVSxFQUFFO0lBQ1pMLGdCQUFnQixDQUFDM0IsS0FBSyxFQUFFbUIsWUFBWSxDQUFDO0VBQ3pDLENBQUM7RUFDRCxJQUFNd0IsUUFBUSxHQUFHLFNBQVhBLFFBQVEsR0FBUztJQUNuQixJQUFHeEIsWUFBWSxLQUFLLENBQUMsSUFBSWIsUUFBUSxLQUFLLEtBQUssRUFBQztNQUN4Q2EsWUFBWSxHQUFHVixVQUFVLEdBQUdLLGFBQWE7TUFDekNNLGFBQWEsR0FBSSxDQUFDWCxVQUFVLEdBQUdLLGFBQWEsS0FBS0gsU0FBUyxHQUFHRSxXQUFXLENBQUMsSUFBSUYsU0FBUyxHQUFHRSxXQUFXLENBQUM7SUFDekcsQ0FBQyxNQUFLLElBQUlNLFlBQVksS0FBSyxDQUFDLEVBQUU7TUFDMUJDLGFBQWEsR0FBRyxDQUFDO01BQ2pCRCxZQUFZLEdBQUcsQ0FBQztJQUNwQixDQUFDLE1BQUssSUFBR0EsWUFBWSxLQUFLLENBQUMsSUFBSWIsUUFBUSxLQUFLLElBQUksRUFBQztNQUM3Q2EsWUFBWSxHQUFHVixVQUFVO01BQ3pCVyxhQUFhLEdBQUdYLFVBQVUsSUFBS0UsU0FBUyxHQUFHRSxXQUFXLENBQUMsSUFBSUYsU0FBUyxHQUFHRSxXQUFXLENBQUM7SUFDdkYsQ0FBQyxNQUFLO01BQ0ZPLGFBQWEsSUFBSVQsU0FBUyxHQUFHRSxXQUFXO01BQ3hDTSxZQUFZLEVBQUU7SUFDbEI7SUFDQWtCLGdCQUFnQixDQUFDakIsYUFBYSxDQUFDO0lBQy9CWSxVQUFVLEVBQUU7SUFDWkwsZ0JBQWdCLENBQUMzQixLQUFLLEVBQUVtQixZQUFZLENBQUM7RUFDekMsQ0FBQzs7RUFFRDtFQUNBO0VBQ0E7RUFDQTtFQUNBOztFQU1BO0VBQ0EsQ0FBQyxZQUFZO0lBQ1QsSUFBSXlCLEtBQUssR0FBRyxHQUFHO0lBRWYsU0FBU0MsU0FBUyxDQUFDQyxPQUFPLEVBQUU7TUFDeEIsSUFBSSxDQUFDQyxRQUFRLEdBQUdELE9BQU87TUFDdkIsSUFBSSxDQUFDRSxNQUFNLEdBQUdsRCxRQUFRLENBQUN5QixhQUFhLENBQUMsUUFBUSxDQUFDO01BQzlDLElBQUksQ0FBQzBCLEdBQUcsR0FBRyxJQUFJLENBQUNELE1BQU0sQ0FBQ0UsVUFBVSxDQUFDLElBQUksQ0FBQztNQUN2QyxJQUFJLENBQUNDLEtBQUssR0FBRyxJQUFJLENBQUNKLFFBQVEsQ0FBQ25DLFdBQVc7TUFDdEMsSUFBSSxDQUFDd0MsTUFBTSxHQUFHLElBQUksQ0FBQ0wsUUFBUSxDQUFDTSxZQUFZO01BQ3hDLElBQUksQ0FBQ0MsTUFBTSxHQUFHLEtBQUs7TUFDbkIsSUFBSSxDQUFDQyxVQUFVLEdBQUcsRUFBRTtNQUVwQixJQUFJLENBQUNDLElBQUksRUFBRTtJQUNmO0lBRUFYLFNBQVMsQ0FBQ1ksU0FBUyxDQUFDRCxJQUFJLEdBQUcsWUFBWTtNQUNuQyxJQUFJLENBQUNSLE1BQU0sQ0FBQ1QsS0FBSyxDQUFDRCxRQUFRLEdBQUcsVUFBVTtNQUN2QyxJQUFJLENBQUNVLE1BQU0sQ0FBQ1QsS0FBSyxDQUFDbUIsSUFBSSxHQUFHLElBQUksQ0FBQ1YsTUFBTSxDQUFDVCxLQUFLLENBQUNvQixHQUFHLEdBQUcsR0FBRztNQUNwRCxJQUFJLENBQUNaLFFBQVEsQ0FBQ3JCLFdBQVcsQ0FBQyxJQUFJLENBQUNzQixNQUFNLENBQUM7TUFFdEMsSUFBSSxDQUFDWSxRQUFRLEVBQUU7TUFDZnJELE1BQU0sQ0FBQ3NELGdCQUFnQixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUNELFFBQVEsQ0FBQ0UsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssQ0FBQztNQUVsRSxLQUFLLElBQUl6QyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUd1QixLQUFLLEVBQUV2QixDQUFDLEVBQUUsRUFBRTtRQUM1QixJQUFJMEMsU0FBUyxHQUFHLElBQUksSUFBSSxDQUFDQyxTQUFTLENBQUMsSUFBSSxDQUFDO1FBQ3hDRCxTQUFTLENBQUNFLEtBQUssRUFBRTtRQUNqQixJQUFJLENBQUNWLFVBQVUsQ0FBQ1csSUFBSSxDQUFDSCxTQUFTLENBQUM7TUFDbkM7TUFFQSxJQUFJLElBQUksQ0FBQ1QsTUFBTSxFQUFFO1FBQ2JhLGdCQUFnQixDQUFDLElBQUksQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7TUFDNUM7SUFDSixDQUFDO0lBRURqQixTQUFTLENBQUNZLFNBQVMsQ0FBQ0csUUFBUSxHQUFHLFlBQVk7TUFDdkMsSUFBSSxDQUFDVCxLQUFLLEdBQUcsSUFBSSxDQUFDSixRQUFRLENBQUNuQyxXQUFXO01BQ3RDLElBQUksQ0FBQ3dDLE1BQU0sR0FBRyxJQUFJLENBQUNMLFFBQVEsQ0FBQ00sWUFBWTtNQUN4QyxJQUFJLENBQUNMLE1BQU0sQ0FBQ0csS0FBSyxHQUFHLElBQUksQ0FBQ0EsS0FBSztNQUM5QixJQUFJLENBQUNILE1BQU0sQ0FBQ0ksTUFBTSxHQUFHLElBQUksQ0FBQ0EsTUFBTTtNQUNoQyxJQUFJLENBQUNILEdBQUcsQ0FBQ29CLFNBQVMsR0FBRyxNQUFNO01BRTNCLElBQUlDLFNBQVMsR0FBRyxJQUFJLENBQUNoQixNQUFNO01BQzNCLElBQUksQ0FBQ0EsTUFBTSxHQUFHLElBQUksQ0FBQ0gsS0FBSyxHQUFHLEVBQUU7TUFDN0IsSUFBSSxDQUFDQSxLQUFLLEdBQUcsR0FBRyxHQUFHUCxLQUFLLEdBQUcsR0FBRyxHQUFHLElBQUk7TUFFckMsSUFBSSxDQUFDMEIsU0FBUyxJQUFJLElBQUksQ0FBQ2hCLE1BQU0sRUFBRTtRQUMzQmEsZ0JBQWdCLENBQUMsSUFBSSxDQUFDQyxNQUFNLENBQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztNQUM1QztJQUNKLENBQUM7SUFFRGpCLFNBQVMsQ0FBQ1ksU0FBUyxDQUFDVyxNQUFNLEdBQUcsWUFBWTtNQUNyQyxJQUFJLENBQUNuQixHQUFHLENBQUNzQixTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUNwQixLQUFLLEVBQUUsSUFBSSxDQUFDQyxNQUFNLENBQUM7TUFFakQsSUFBSSxDQUFDLElBQUksQ0FBQ0UsTUFBTSxFQUFFO1FBQ2Q7TUFDSjtNQUVBLEtBQUssSUFBSWpDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR3VCLEtBQUssRUFBRXZCLENBQUMsRUFBRSxFQUFFO1FBQzVCLElBQUkwQyxTQUFTLEdBQUcsSUFBSSxDQUFDUixVQUFVLENBQUNsQyxDQUFDLENBQUM7UUFDbEMwQyxTQUFTLENBQUNTLENBQUMsSUFBSVQsU0FBUyxDQUFDVSxFQUFFO1FBQzNCVixTQUFTLENBQUNXLENBQUMsSUFBSVgsU0FBUyxDQUFDWSxFQUFFO1FBRTNCLElBQUksQ0FBQzFCLEdBQUcsQ0FBQzJCLFdBQVcsR0FBR2IsU0FBUyxDQUFDYyxDQUFDO1FBQ2xDLElBQUksQ0FBQzVCLEdBQUcsQ0FBQzZCLFNBQVMsRUFBRTtRQUNwQixJQUFJLENBQUM3QixHQUFHLENBQUM4QixHQUFHLENBQUNoQixTQUFTLENBQUNXLENBQUMsRUFBRVgsU0FBUyxDQUFDUyxDQUFDLEVBQUVULFNBQVMsQ0FBQ2lCLENBQUMsRUFBRSxDQUFDLEVBQUVqRSxJQUFJLENBQUNrRSxFQUFFLEdBQUcsQ0FBQyxFQUFFLEtBQUssQ0FBQztRQUMxRSxJQUFJLENBQUNoQyxHQUFHLENBQUNpQyxTQUFTLEVBQUU7UUFDcEIsSUFBSSxDQUFDakMsR0FBRyxDQUFDa0MsSUFBSSxFQUFFO1FBRWYsSUFBSXBCLFNBQVMsQ0FBQ1MsQ0FBQyxHQUFHLElBQUksQ0FBQ3BCLE1BQU0sRUFBRTtVQUMzQlcsU0FBUyxDQUFDRSxLQUFLLEVBQUU7UUFDckI7TUFDSjtNQUVBRSxnQkFBZ0IsQ0FBQyxJQUFJLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRGpCLFNBQVMsQ0FBQ1ksU0FBUyxDQUFDTyxTQUFTLEdBQUcsVUFBVW9CLFNBQVMsRUFBRTtNQUNqRCxJQUFJLENBQUNBLFNBQVMsR0FBR0EsU0FBUztNQUMxQixJQUFJLENBQUNuQixLQUFLLEVBQUU7SUFDaEIsQ0FBQztJQUVEcEIsU0FBUyxDQUFDWSxTQUFTLENBQUNPLFNBQVMsQ0FBQ1AsU0FBUyxDQUFDUSxLQUFLLEdBQUcsWUFBWTtNQUN4RCxJQUFJLENBQUNTLENBQUMsR0FBRzNELElBQUksQ0FBQ3NFLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQ0QsU0FBUyxDQUFDakMsS0FBSztNQUM3QyxJQUFJLENBQUNxQixDQUFDLEdBQUd6RCxJQUFJLENBQUNzRSxNQUFNLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQ0QsU0FBUyxDQUFDaEMsTUFBTTtNQUMvQyxJQUFJLENBQUNxQixFQUFFLEdBQUcsR0FBRyxHQUFHMUQsSUFBSSxDQUFDc0UsTUFBTSxFQUFFLEdBQUcsT0FBTztNQUN2QyxJQUFJLENBQUNWLEVBQUUsR0FBRyxHQUFHLEdBQUc1RCxJQUFJLENBQUNzRSxNQUFNLEVBQUU7TUFDN0IsSUFBSSxDQUFDTCxDQUFDLEdBQUcsQ0FBQyxHQUFHakUsSUFBSSxDQUFDc0UsTUFBTSxFQUFFLEdBQUcsQ0FBQztNQUM5QixJQUFJLENBQUNSLENBQUMsR0FBRyxDQUFDO0lBQ2QsQ0FBQzs7SUFFRDtJQUNBdEUsTUFBTSxDQUFDNEQsZ0JBQWdCLEdBQUksWUFBWTtNQUNuQyxPQUFPNUQsTUFBTSxDQUFDK0UscUJBQXFCLElBQy9CL0UsTUFBTSxDQUFDZ0YsMkJBQTJCLElBQ2xDaEYsTUFBTSxDQUFDaUYsd0JBQXdCLElBQy9CLFVBQVVDLFFBQVEsRUFBRTtRQUNoQmxGLE1BQU0sQ0FBQ21GLFVBQVUsQ0FBQ0QsUUFBUSxFQUFFLElBQUksR0FBRyxFQUFFLENBQUM7TUFDMUMsQ0FBQztJQUNULENBQUMsRUFBRzs7SUFFSjtJQUNBLElBQUlFLEtBQUssR0FBRzdGLFFBQVEsQ0FBQ0csZ0JBQWdCLENBQUMsTUFBTSxDQUFDO0lBQzdDMEYsS0FBSyxDQUFDOUQsT0FBTyxDQUFDLFVBQVUrRCxHQUFHLEVBQUU7TUFDekIsSUFBSS9DLFNBQVMsQ0FBQytDLEdBQUcsQ0FBQztJQUN0QixDQUFDLENBQUM7RUFDTixDQUFDLEdBQUc7RUFFSixJQUFNQyxZQUFZLEdBQUcsU0FBZkEsWUFBWSxHQUFRO0lBQ3RCLElBQUlDLFdBQVcsR0FBRyxDQUFDO0lBQ25CLElBQUlDLFNBQVMsR0FBRyxDQUFDO0lBQ2pCLElBQU1DLGdCQUFnQixHQUFHLFNBQW5CQSxnQkFBZ0IsQ0FBSUMsS0FBSyxFQUFLO01BQ2hDSCxXQUFXLEdBQUdHLEtBQUssQ0FBQ0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxPQUFPO0lBQzFDLENBQUM7SUFDRCxJQUFNQyxlQUFlLEdBQUcsU0FBbEJBLGVBQWUsQ0FBSUgsS0FBSyxFQUFLO01BQy9CRixTQUFTLEdBQUdFLEtBQUssQ0FBQ0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxPQUFPO0lBQ3hDLENBQUM7SUFDRCxJQUFNRSxjQUFjLEdBQUcsU0FBakJBLGNBQWMsR0FBUztNQUN6QixJQUFNQyxhQUFhLEdBQUdSLFdBQVcsR0FBR0MsU0FBUztNQUM3QyxJQUFJTyxhQUFhLEdBQUcsRUFBRSxFQUFFO1FBQ3BCO1FBQ0E3RCxTQUFTLEVBQUU7TUFDZixDQUFDLE1BQU0sSUFBSTZELGFBQWEsR0FBRyxDQUFDLEVBQUUsRUFBRTtRQUM1QjtRQUNBM0QsUUFBUSxFQUFFO01BQ2Q7TUFDQTtNQUNBbUQsV0FBVyxHQUFHLENBQUM7TUFDZkMsU0FBUyxHQUFHLENBQUM7SUFDakIsQ0FBQztJQUVENUYsZUFBZSxDQUFDMEQsZ0JBQWdCLENBQUMsT0FBTyxFQUFFcEIsU0FBUyxDQUFDO0lBQ3BEckMsY0FBYyxDQUFDeUQsZ0JBQWdCLENBQUMsT0FBTyxFQUFFbEIsUUFBUSxDQUFDO0lBQ2xEOUMsY0FBYyxDQUFDZ0UsZ0JBQWdCLENBQUMsWUFBWSxFQUFFbUMsZ0JBQWdCLENBQUM7SUFDL0RuRyxjQUFjLENBQUNnRSxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUV1QyxlQUFlLENBQUM7SUFDN0R2RyxjQUFjLENBQUNnRSxnQkFBZ0IsQ0FBQyxVQUFVLEVBQUV3QyxjQUFjLENBQUM7SUFDM0Q5RixNQUFNLENBQUNzRCxnQkFBZ0IsQ0FBQyxtQkFBbUIsRUFBRSxZQUFLO01BQzlDMEMsUUFBUSxDQUFDQyxNQUFNLEVBQUU7SUFDckIsQ0FBQyxDQUFDO0VBQ04sQ0FBQztFQUVEWCxZQUFZLEVBQUU7QUFFbEIsQ0FBQyxHQUFHIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAgIC8vIENhcmRzIHNsaWRlclxuICAgIGNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByaXplX19saXN0JyksXG4gICAgICAgICAgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJpemVfX2xpc3QtaXRlbScpLFxuICAgICAgICAgIGNhcmRzV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcml6ZV9fbGlzdC1zY3JvbGwnKSxcbiAgICAgICAgICBtb3ZlUmlnaHRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJpemVfX3NsaWRlci1tb3ZlLXJpZ2h0JyksXG4gICAgICAgICAgbW92ZUxlZnRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJpemVfX3NsaWRlci1tb3ZlLWxlZnQnKSxcbiAgICAgICAgICB0YWJzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByaXplX190YWJzJyksXG4gICAgICAgICAgaXNNb2JpbGUgPSB3aW5kb3cuaW5uZXJXaWR0aCA8IDYwMCxcbiAgICAgICAgICB0b3RhbENhcmRzID0gY2FyZHMubGVuZ3RoLFxuICAgICAgICAgIGNhcmRXaWR0aCA9IGNhcmRzWzBdLmNsaWVudFdpZHRoLFxuICAgICAgICAgIGNhcmRzTWFyZ2luID0gKGNhcmRzV3JhcC5jbGllbnRXaWR0aCAtIGNhcmRXaWR0aCAqIHRvdGFsQ2FyZHMpIC8gKHRvdGFsQ2FyZHMgLSAxKSxcbiAgICAgICAgICB2aXNpYmxlU2xpZGVzID0gaXNNb2JpbGUgPyAxIDogTWF0aC5mbG9vcihjYXJkc0NvbnRhaW5lci5jbGllbnRXaWR0aCAvIChjYXJkV2lkdGggKyBjYXJkc01hcmdpbikpLFxuICAgICAgICAgIHRvdGFsVGFicyA9IE1hdGguY2VpbCh0b3RhbENhcmRzIC8gdmlzaWJsZVNsaWRlcylcblxuICAgIGxldCBjdXJyZW50U2xpZGUgPSAxO1xuICAgIGxldCBjYXJkc1Bvc2l0aW9uID0gMFxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSB0b3RhbFRhYnM7IGkrKykge1xuICAgICAgICAgICAgaWYoIWlzTW9iaWxlICYmIGkgPT09IHRvdGFsVGFicyApe1xuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0YWIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHRhYi5jbGFzc0xpc3QuYWRkKCdwcml6ZV9fdGFicy1pdGVtJyk7XG4gICAgICAgICAgICB0YWJzQ29udGFpbmVyLmFwcGVuZENoaWxkKHRhYik7XG4gICAgICAgIH1cblxuICAgIGNvbnN0IHVwZGF0ZUFjdGl2ZUNhcmQgPSAoY2FyZHMsIGFjdGl2ZUluZGV4KSA9PiB7XG4gICAgICAgIGNhcmRzLmZvckVhY2goKGNhcmQsIGkpID0+e1xuICAgICAgICAgICAgYWN0aXZlSW5kZXggLSAxID09PSBpID8gY2FyZC5jbGFzc0xpc3QuYWRkKFwiX2FjdGl2ZVwiKSA6IGNhcmQuY2xhc3NMaXN0LnJlbW92ZShcIl9hY3RpdmVcIilcbiAgICAgICAgfSlcbiAgICB9XG4gICAgdXBkYXRlQWN0aXZlQ2FyZChjYXJkcywgY3VycmVudFNsaWRlKVxuXG4gICAgY29uc3QgdXBkYXRlVGFicyA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlVGFiID0gTWF0aC5jZWlsKGN1cnJlbnRTbGlkZSAvIHZpc2libGVTbGlkZXMpO1xuICAgICAgICB0YWJzQ29udGFpbmVyLmNoaWxkTm9kZXMuZm9yRWFjaCgodGFiLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgdGFiLmNsYXNzTGlzdC50b2dnbGUoJ19hY3RpdmUnLCBpbmRleCArIDEgPT09IGFjdGl2ZVRhYik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgdXBkYXRlVGFicygpO1xuICAgIGZ1bmN0aW9uIHNldENhcmRzUG9zaXRpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgIGNhcmRzV3JhcC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgtJHtwb3NpdGlvbn1weClgO1xuICAgIH07XG4gICAgY29uc3QgbW92ZVJpZ2h0ID0gKCkgPT4ge1xuICAgICAgICBpZiAoY3VycmVudFNsaWRlID49IHRvdGFsQ2FyZHMgLSB2aXNpYmxlU2xpZGVzICYmIGlzTW9iaWxlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgY3VycmVudFNsaWRlID0gMTtcbiAgICAgICAgICAgIGNhcmRzUG9zaXRpb24gPSAwO1xuICAgICAgICB9ZWxzZSBpZihjdXJyZW50U2xpZGUgPT09IHRvdGFsQ2FyZHMpIHtcbiAgICAgICAgICAgIGN1cnJlbnRTbGlkZSA9IDE7XG4gICAgICAgICAgICBjYXJkc1Bvc2l0aW9uID0gMDtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbWF4UG9zaXRpb24gPSAodG90YWxDYXJkcyAtIHZpc2libGVTbGlkZXMpICogKGNhcmRXaWR0aCArIGNhcmRzTWFyZ2luKTtcbiAgICAgICAgICAgIGlmIChjYXJkc1Bvc2l0aW9uICsgY2FyZFdpZHRoICsgY2FyZHNNYXJnaW4gPiBtYXhQb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIGNhcmRzUG9zaXRpb24gPSBtYXhQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICBjdXJyZW50U2xpZGUgPSB0b3RhbENhcmRzIC0gdmlzaWJsZVNsaWRlcyArIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhcmRzUG9zaXRpb24gKz0gY2FyZFdpZHRoICsgY2FyZHNNYXJnaW47XG4gICAgICAgICAgICAgICAgY3VycmVudFNsaWRlKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0Q2FyZHNQb3NpdGlvbihjYXJkc1Bvc2l0aW9uKTtcbiAgICAgICAgdXBkYXRlVGFicygpO1xuICAgICAgICB1cGRhdGVBY3RpdmVDYXJkKGNhcmRzLCBjdXJyZW50U2xpZGUpXG4gICAgfTtcbiAgICBjb25zdCBtb3ZlTGVmdCA9ICgpID0+IHtcbiAgICAgICAgaWYoY3VycmVudFNsaWRlID09PSAxICYmIGlzTW9iaWxlID09PSBmYWxzZSl7XG4gICAgICAgICAgICBjdXJyZW50U2xpZGUgPSB0b3RhbENhcmRzIC0gdmlzaWJsZVNsaWRlcztcbiAgICAgICAgICAgIGNhcmRzUG9zaXRpb24gPSAoKHRvdGFsQ2FyZHMgLSB2aXNpYmxlU2xpZGVzKSAqIChjYXJkV2lkdGggKyBjYXJkc01hcmdpbikpIC0oY2FyZFdpZHRoICsgY2FyZHNNYXJnaW4pO1xuICAgICAgICB9ZWxzZSBpZiAoY3VycmVudFNsaWRlID09PSAyKSB7XG4gICAgICAgICAgICBjYXJkc1Bvc2l0aW9uID0gMFxuICAgICAgICAgICAgY3VycmVudFNsaWRlID0gMVxuICAgICAgICB9ZWxzZSBpZihjdXJyZW50U2xpZGUgPT09IDEgJiYgaXNNb2JpbGUgPT09IHRydWUpe1xuICAgICAgICAgICAgY3VycmVudFNsaWRlID0gdG90YWxDYXJkc1xuICAgICAgICAgICAgY2FyZHNQb3NpdGlvbiA9IHRvdGFsQ2FyZHMgICogKGNhcmRXaWR0aCArIGNhcmRzTWFyZ2luKSAtIChjYXJkV2lkdGggKyBjYXJkc01hcmdpbilcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgY2FyZHNQb3NpdGlvbiAtPSBjYXJkV2lkdGggKyBjYXJkc01hcmdpbjtcbiAgICAgICAgICAgIGN1cnJlbnRTbGlkZS0tXG4gICAgICAgIH1cbiAgICAgICAgc2V0Q2FyZHNQb3NpdGlvbihjYXJkc1Bvc2l0aW9uKTtcbiAgICAgICAgdXBkYXRlVGFicygpO1xuICAgICAgICB1cGRhdGVBY3RpdmVDYXJkKGNhcmRzLCBjdXJyZW50U2xpZGUpXG4gICAgfTtcblxuICAgIC8vIGZ1bmN0aW9uIGNlbnRlclN0YXJ0UG9zaXRpb24oKSB7XG4gICAgLy8gICAgICAgICBjb25zdCBzdGFydE9mZnNldCA9ICh3aW5kb3cuaW5uZXJXaWR0aCAvIDIpIC0gKChjYXJkV2lkdGggKyBjYXJkc01hcmdpbikgLyAyKTtcbiAgICAvLyAgICAgICAgIGNhcmRzUG9zaXRpb24gPSBzdGFydE9mZnNldCA+IDAgPyBzdGFydE9mZnNldCA6IDA7XG4gICAgLy8gICAgICAgICBzZXRDYXJkc1Bvc2l0aW9uKGNhcmRzUG9zaXRpb24pO1xuICAgIC8vIH07XG5cblxuXG5cblxuICAgIC8vIHNub3dmYWxsIGFuaW1hdGlvbnNcbiAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgQ09VTlQgPSA0MDA7XG5cbiAgICAgICAgZnVuY3Rpb24gU25vd3N0b3JtKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMubWFzdGhlYWQgPSBlbGVtZW50O1xuICAgICAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgICAgIHRoaXMuY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLm1hc3RoZWFkLmNsaWVudFdpZHRoO1xuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLm1hc3RoZWFkLmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNub3dmbGFrZXMgPSBbXTtcblxuICAgICAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBTbm93c3Rvcm0ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5sZWZ0ID0gdGhpcy5jYW52YXMuc3R5bGUudG9wID0gJzAnO1xuICAgICAgICAgICAgdGhpcy5tYXN0aGVhZC5hcHBlbmRDaGlsZCh0aGlzLmNhbnZhcyk7XG5cbiAgICAgICAgICAgIHRoaXMub25SZXNpemUoKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLm9uUmVzaXplLmJpbmQodGhpcyksIGZhbHNlKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBDT1VOVDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNub3dmbGFrZSA9IG5ldyB0aGlzLlNub3dmbGFrZSh0aGlzKTtcbiAgICAgICAgICAgICAgICBzbm93Zmxha2UucmVzZXQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNub3dmbGFrZXMucHVzaChzbm93Zmxha2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbUZyYW1lKHRoaXMudXBkYXRlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIFNub3dzdG9ybS5wcm90b3R5cGUub25SZXNpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5tYXN0aGVhZC5jbGllbnRXaWR0aDtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5tYXN0aGVhZC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMud2lkdGg7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmhlaWdodDtcbiAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9ICcjRkZGJztcblxuICAgICAgICAgICAgdmFyIHdhc0FjdGl2ZSA9IHRoaXMuYWN0aXZlO1xuICAgICAgICAgICAgdGhpcy5hY3RpdmUgPSB0aGlzLndpZHRoID4gODA7XG4gICAgICAgICAgICB0aGlzLndpZHRoID4gMjgwID8gQ09VTlQgPSAxNTAgOiBudWxsXG5cbiAgICAgICAgICAgIGlmICghd2FzQWN0aXZlICYmIHRoaXMuYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1GcmFtZSh0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBTbm93c3Rvcm0ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgQ09VTlQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzbm93Zmxha2UgPSB0aGlzLnNub3dmbGFrZXNbaV07XG4gICAgICAgICAgICAgICAgc25vd2ZsYWtlLnkgKz0gc25vd2ZsYWtlLnZ5O1xuICAgICAgICAgICAgICAgIHNub3dmbGFrZS54ICs9IHNub3dmbGFrZS52eDtcblxuICAgICAgICAgICAgICAgIHRoaXMuY3R4Lmdsb2JhbEFscGhhID0gc25vd2ZsYWtlLm87XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguYXJjKHNub3dmbGFrZS54LCBzbm93Zmxha2UueSwgc25vd2ZsYWtlLnIsIDAsIE1hdGguUEkgKiAyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNub3dmbGFrZS55ID4gdGhpcy5oZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc25vd2ZsYWtlLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXF1ZXN0QW5pbUZyYW1lKHRoaXMudXBkYXRlLmJpbmQodGhpcykpO1xuICAgICAgICB9O1xuXG4gICAgICAgIFNub3dzdG9ybS5wcm90b3R5cGUuU25vd2ZsYWtlID0gZnVuY3Rpb24gKHNub3dzdG9ybSkge1xuICAgICAgICAgICAgdGhpcy5zbm93c3Rvcm0gPSBzbm93c3Rvcm07XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgU25vd3N0b3JtLnByb3RvdHlwZS5Tbm93Zmxha2UucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy54ID0gTWF0aC5yYW5kb20oKSAqIHRoaXMuc25vd3N0b3JtLndpZHRoO1xuICAgICAgICAgICAgdGhpcy55ID0gTWF0aC5yYW5kb20oKSAqIC10aGlzLnNub3dzdG9ybS5oZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLnZ5ID0gMC4zICsgTWF0aC5yYW5kb20oKSAqIDAuMDAwMDE7XG4gICAgICAgICAgICB0aGlzLnZ4ID0gMC42IC0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgICAgIHRoaXMuciA9IDEgKyBNYXRoLnJhbmRvbSgpICogMjtcbiAgICAgICAgICAgIHRoaXMubyA9IDE7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc2hpbSBsYXllciB3aXRoIHNldFRpbWVvdXQgZmFsbGJhY2tcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltRnJhbWUgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgICAgICAgICAgICB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICAgICAgICAgICAgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9KSgpO1xuXG4gICAgICAgIC8vIEFwcGx5IFNub3dzdG9ybSB0byBhbGwgZWxlbWVudHMgd2l0aCB0aGUgY2xhc3MgJ3NreSdcbiAgICAgICAgdmFyIHNraWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNreScpO1xuICAgICAgICBza2llcy5mb3JFYWNoKGZ1bmN0aW9uIChza3kpIHtcbiAgICAgICAgICAgIG5ldyBTbm93c3Rvcm0oc2t5KTtcbiAgICAgICAgfSk7XG4gICAgfSkoKTtcblxuICAgIGNvbnN0IGhhbmRsZVJlc2l6ZSA9ICgpID0+e1xuICAgICAgICBsZXQgdG91Y2hTdGFydFggPSAwO1xuICAgICAgICBsZXQgdG91Y2hFbmRYID0gMDtcbiAgICAgICAgY29uc3QgaGFuZGxlVG91Y2hTdGFydCA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgdG91Y2hTdGFydFggPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGhhbmRsZVRvdWNoTW92ZSA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgdG91Y2hFbmRYID0gZXZlbnQudG91Y2hlc1swXS5jbGllbnRYO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBoYW5kbGVUb3VjaEVuZCA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN3aXBlRGlzdGFuY2UgPSB0b3VjaFN0YXJ0WCAtIHRvdWNoRW5kWDtcbiAgICAgICAgICAgIGlmIChzd2lwZURpc3RhbmNlID4gNTApIHtcbiAgICAgICAgICAgICAgICAvLyDQodCy0LDQudC/INC70ZbQstC+0YDRg9GHXG4gICAgICAgICAgICAgICAgbW92ZVJpZ2h0KCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN3aXBlRGlzdGFuY2UgPCAtNTApIHtcbiAgICAgICAgICAgICAgICAvLyDQodCy0LDQudC/INC/0YDQsNCy0L7RgNGD0YdcbiAgICAgICAgICAgICAgICBtb3ZlTGVmdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8g0KHQutC40LTQsNGU0LzQviDQt9C90LDRh9C10L3QvdGPXG4gICAgICAgICAgICB0b3VjaFN0YXJ0WCA9IDA7XG4gICAgICAgICAgICB0b3VjaEVuZFggPSAwO1xuICAgICAgICB9O1xuXG4gICAgICAgIG1vdmVSaWdodEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG1vdmVSaWdodCk7XG4gICAgICAgIG1vdmVMZWZ0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbW92ZUxlZnQpO1xuICAgICAgICBjYXJkc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgaGFuZGxlVG91Y2hTdGFydCk7XG4gICAgICAgIGNhcmRzQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGhhbmRsZVRvdWNoTW92ZSk7XG4gICAgICAgIGNhcmRzQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgaGFuZGxlVG91Y2hFbmQpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsICgpID0+e1xuICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBoYW5kbGVSZXNpemUoKVxuXG59KSgpOyJdfQ==
